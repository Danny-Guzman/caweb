(function(b){var c;var a;b(function(){var d=b(".available-headers");d.imagesLoaded(function(){d.masonry({itemSelector:".default-header",isRTL:!!("undefined"!=typeof isRtl&&isRtl)})});b(document).on("click","div .library-link",function(h){var g=b(this);a=this.name;h.preventDefault();var f=g.data("option");var j=g.data("uploader");var e=j?"":"hidden-upload";var i=g.data("icon-check")&&g.attr("data-icon-check");if(!!f&&f.indexOf(",")>0){f=f.split(",")}if(c){}c=wp.media.frames.customHeader=wp.media({title:g.data("choose"),library:{type:f},uploader:j,button:{text:g.data("update"),close:true}});c.on("select",function(){var o=c.state().get("selection").first(),m=g.data("updateLink");var q=document.getElementById(a);var l=document.getElementById(a+"_img");var p=document.getElementById(a+"_filename");var n={action:"caweb_fav_icon_check",icon_url:o.attributes.url,};if(/\d+_media_image/.test(a)){var k=document.getElementById(a.substring(0,a.indexOf("_"))+"_caweb_nav_media_image_alt_text");q.value=o.attributes.url;k.value=o.attributes.alt}else{if("true"!==i){q.value=o.attributes.url;if(null!==l){l.src=o.attributes.url}if(null!==p){p.value=o.attributes.filename}}else{jQuery.post(ajaxurl,n,function(r){if(1==r){l.src=o.attributes.url;q.value=o.attributes.url;p.value=o.attributes.filename}else{alert("Invalid Icon Mime Type: "+o.attributes.filename)}})}}});c.on("open",function(){if(!j){var k=c.el.getElementsByClassName("media-frame-router")[0].getElementsByClassName("media-router")[0].getElementsByClassName("media-menu-item");k[1].click();k[0].parentNode.removeChild(k[0])}});c.open()})})}(jQuery));